<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community OS Titanium - v4.0 Final</title>
    
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

    <style>
        /* --- 1. CORE SYSTEM CSS (Phần này rất dài để tạo giao diện xịn) --- */
        :root {
            --glass: rgba(15, 15, 15, 0.7);
            --glass-border: rgba(255, 255, 255, 0.12);
            --accent: #0078d4;
            --taskbar-bg: rgba(20, 20, 20, 0.85);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; cursor: default; -webkit-font-smoothing: antialiased; }
        body {
            background: url('https://w.wallhaven.cc/full/pk/wallhaven-pk63m9.jpg') no-repeat center center fixed;
            background-size: cover; height: 100vh; font-family: 'Segoe UI', system-ui; color: white; overflow: hidden;
        }

        /* --- BOOT SCREEN --- */
        #boot-screen {
            position: fixed; inset: 0; background: black; z-index: 99999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .spinner { width: 40px; height: 40px; border: 4px solid #333; border-top-color: var(--accent); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* --- DESKTOP ENGINE --- */
        #desktop { height: calc(100vh - 50px); position: relative; padding: 10px; z-index: 10; }
        
        .desktop-grid {
            display: grid; grid-template-columns: repeat(auto-fill, 90px);
            grid-template-rows: repeat(auto-fill, 100px); grid-flow: column; gap: 10px; height: 100%;
        }

        .icon {
            width: 85px; height: 95px; display: flex; flex-direction: column; align-items: center;
            justify-content: center; border-radius: 6px; transition: 0.2s; border: 1px solid transparent;
        }
        .icon:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.2); }
        .icon i { font-size: 36px; margin-bottom: 8px; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.4)); }
        .icon span { font-size: 11px; text-align: center; text-shadow: 1px 1px 3px black; font-weight: 500; }

        /* --- WINDOWS FRAMEWORK --- */
        .window {
            position: absolute; background: var(--glass); backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border); border-radius: 10px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.6); display: none; flex-direction: column;
            z-index: 100; min-width: 250px; min-height: 150px;
        }
        .title-bar {
            height: 38px; padding: 0 12px; display: flex; justify-content: space-between;
            align-items: center; background: rgba(255, 255, 255, 0.05); cursor: move; border-radius: 10px 10px 0 0;
        }
        .win-title { font-size: 12px; font-weight: 600; display: flex; align-items: center; gap: 8px; }
        .win-controls { display: flex; gap: 8px; }
        .dot { width: 12px; height: 12px; border-radius: 50%; cursor: pointer; }
        .dot-close { background: #ff5f56; } .dot-min { background: #ffbd2e; } .dot-max { background: #27c93f; }

        .content { flex: 1; overflow: auto; position: relative; }

        /* --- APPS SPECIFIC --- */
        #terminal-out { background: #000; color: #0f0; font-family: 'Consolas', monospace; padding: 15px; height: 100%; overflow-y: auto; font-size: 13px; }
        .file-item { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); display: flex; align-items: center; gap: 10px; cursor: pointer; }
        .file-item:hover { background: rgba(255,255,255,0.1); }

        /* --- TASKBAR & START --- */
        #taskbar {
            position: fixed; bottom: 0; left: 0; right: 0; height: 50px;
            background: var(--taskbar-bg); backdrop-filter: blur(20px);
            display: flex; justify-content: space-between; align-items: center; padding: 0 15px; z-index: 10000;
        }
        .start-btn { font-size: 24px; color: #0078d4; cursor: pointer; transition: 0.3s; }
        .start-btn:hover { transform: scale(1.2) rotate(180deg); }

        #start-menu {
            position: absolute; bottom: 60px; left: 10px; width: 450px; height: 550px;
            background: rgba(15, 15, 15, 0.95); backdrop-filter: blur(30px); border-radius: 12px;
            border: 1px solid var(--glass-border); display: none; z-index: 10001; padding: 25px;
        }

        /* --- WIDGETS --- */
        .widget { position: absolute; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 15px; backdrop-filter: blur(10px); }
        #weather-widget { top: 20px; right: 20px; width: 200px; }

        /* --- CONTEXT MENU --- */
        #context-menu {
            position: absolute; background: rgba(30, 30, 30, 0.9); backdrop-filter: blur(15px);
            border: 1px solid #444; border-radius: 8px; width: 180px; display: none; z-index: 100000;
            padding: 5px; box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }
        .menu-item { padding: 8px 12px; font-size: 12px; border-radius: 4px; cursor: pointer; }
        .menu-item:hover { background: var(--accent); }
    </style>
</head>
<body oncontextmenu="return showContextMenu(event)">

    <div id="boot-screen">
        <img src="https://cdn-icons-png.flaticon.com/512/732/732221.png" width="80" class="mb-8">
        <div class="spinner"></div>
        <p class="mt-4 text-gray-500 font-mono text-sm">System Titanium Starting...</p>
    </div>

    <div id="desktop">
        <div class="desktop-grid" id="desktop-icons">
            </div>

        <div class="widget" id="weather-widget">
            <div class="flex justify-between items-center">
                <i class="fas fa-sun text-yellow-400 text-3xl"></i>
                <div class="text-right">
                    <p class="text-2xl font-bold">32°C</p>
                    <p class="text-[10px] text-gray-400">TP. Hồ Chí Minh</p>
                </div>
            </div>
        </div>
    </div>

    <div id="win-terminal" class="window" style="width: 700px; height: 450px;">
        <div class="title-bar">
            <div class="win-title"><i class="fas fa-terminal"></i> Terminal</div>
            <div class="win-controls"><div class="dot dot-min"></div><div class="dot dot-close" onclick="closeWin('win-terminal')"></div></div>
        </div>
        <div class="content" id="terminal-out">
            <div>Community OS Titanium [Version 4.0.Final]</div>
            <div>(c) 2026 Community Corp. All rights reserved.</div><br>
            <div id="term-history"></div>
            <div class="flex"><span>root@community:~$ </span><input type="text" id="term-input" class="bg-transparent border-none outline-none text-green-500 ml-2 w-full"></div>
        </div>
    </div>

    <div id="win-explorer" class="window" style="width: 800px; height: 500px;">
        <div class="title-bar">
            <div class="win-title"><i class="fas fa-folder"></i> File Explorer</div>
            <div class="win-controls"><div class="dot dot-close" onclick="closeWin('win-explorer')"></div></div>
        </div>
        <div class="flex h-full">
            <div class="w-48 bg-white/5 p-4 text-xs border-r border-white/10">
                <p class="mb-4 text-gray-500 uppercase font-bold">Quick Access</p>
                <div class="space-y-3">
                    <div class="hover:text-blue-400 cursor-pointer"><i class="fas fa-home mr-2"></i> Desktop</div>
                    <div class="hover:text-blue-400 cursor-pointer"><i class="fas fa-download mr-2"></i> Downloads</div>
                    <div class="hover:text-blue-400 cursor-pointer"><i class="fas fa-file mr-2"></i> Documents</div>
                </div>
            </div>
            <div class="flex-1 p-4 overflow-y-auto" id="file-list">
                </div>
        </div>
    </div>

    <div id="win-store" class="window" style="width: 900px; height: 600px;">
        <div class="title-bar"><div class="win-title"><i class="fas fa-shopping-bag"></i> App Store</div><div class="win-controls"><div class="dot dot-close" onclick="closeWin('win-store')"></div></div></div>
        <div class="content p-8">
            <h1 class="text-3xl font-bold mb-8">Featured Applications</h1>
            <div class="grid grid-cols-3 gap-6" id="store-items">
                </div>
        </div>
    </div>

    <div id="taskbar">
        <div class="flex items-center gap-4">
            <i class="fab fa-windows start-btn" onclick="$('#start-menu').toggle()"></i>
            <div id="active-apps" class="flex gap-2"></div>
        </div>
        <div class="flex items-center gap-4">
            <div class="text-right leading-tight">
                <p id="clock-time" class="text-sm font-bold">12:00</p>
                <p id="clock-date" class="text-[10px] text-gray-400">01/01/2026</p>
            </div>
            <i class="fas fa-wifi text-xs"></i>
            <i class="fas fa-volume-up text-xs"></i>
        </div>
    </div>

    <div id="context-menu">
        <div class="menu-item" onclick="location.reload()"><i class="fas fa-sync-alt mr-2"></i> Refresh</div>
        <div class="menu-item"><i class="fas fa-sort mr-2"></i> Sort icons</div>
        <hr class="border-white/10 my-1">
        <div class="menu-item" onclick="openWin('win-settings')"><i class="fas fa-desktop mr-2"></i> Personalize</div>
    </div>

    <div id="start-menu">
        <div class="flex items-center gap-4 mb-8">
            <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-xl font-bold">A</div>
            <div><p class="font-bold">Administrator</p><p class="text-xs text-gray-500">Titanium Member</p></div>
        </div>
        <div class="grid grid-cols-2 gap-4" id="start-apps">
            </div>
    </div>

    <audio id="snd-boot" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3"></audio>

    <script>
        // --- DATA REGISTRY (Hệ thống dữ liệu của OS) ---
        const APPS = [
            { id: 'terminal', name: 'Terminal', icon: 'fas fa-terminal', color: 'text-green-500' },
            { id: 'explorer', name: 'Explorer', icon: 'fas fa-folder', color: 'text-yellow-500' },
            { id: 'store', name: 'App Store', icon: 'fas fa-shopping-bag', color: 'text-pink-500' },
            { id: 'browser', name: 'Browser', icon: 'fas fa-globe', color: 'text-blue-500' },
            { id: 'notepad', name: 'Notepad', icon: 'fas fa-file-alt', color: 'text-blue-300' },
            { id: 'taskmgr', name: 'Task Mgr', icon: 'fas fa-microchip', color: 'text-red-500' },
            { id: 'music', name: 'Music', icon: 'fas fa-music', color: 'text-purple-400' },
            { id: 'settings', name: 'Settings', icon: 'fas fa-cog', color: 'text-gray-400' },
            { id: 'paint', name: 'Paint', icon: 'fas fa-paint-brush', color: 'text-orange-400' },
            { id: 'calc', name: 'Calculator', icon: 'fas fa-calculator', color: 'text-indigo-400' },
            { id: 'video', name: 'Video Player', icon: 'fas fa-play-circle', color: 'text-red-400' }
        ];

        const FILES = [
            { name: 'system_core.dll', size: '4.2 MB', type: 'System' },
            { name: 'readme.txt', size: '1 KB', type: 'Text' },
            { name: 'wallpaper.jpg', size: '2.5 MB', type: 'Image' },
            { name: 'password.vault', size: '12 KB', type: 'Secure' }
        ];

        // --- SYSTEM ENGINE ---
        $(document).ready(function() {
            // Boot sequence
            setTimeout(() => {
                $('#boot-screen').fadeOut(1000);
                document.getElementById('snd-boot').play();
            }, 3000);

            initDesktop();
            initStartMenu();
            initStore();
            initTerminal();
            updateClock();
            setInterval(updateClock, 1000);

            // Window Logic
            $('.window').draggable({ handle: '.title-bar', stack: '.window' }).resizable();
            $(document).on('mousedown', '.window', function() {
                $('.window').css('z-index', 100);
                $(this).css('z-index', 1000);
            });
        });

        function initDesktop() {
            const grid = $('#desktop-icons');
            APPS.forEach(app => {
                grid.append(`
                    <div class="icon" ondblclick="openWin('win-${app.id}')">
                        <i class="${app.icon} ${app.color}"></i>
                        <span>${app.name}</span>
                    </div>
                `);
            });
        }

        function initStartMenu() {
            const startGrid = $('#start-apps');
            APPS.forEach(app => {
                startGrid.append(`
                    <div class="flex items-center gap-3 p-3 hover:bg-white/10 rounded-lg cursor-pointer" onclick="openWin('win-${app.id}'); $('#start-menu').hide()">
                        <i class="${app.icon} ${app.color} text-xl"></i>
                        <span class="text-sm font-medium">${app.name}</span>
                    </div>
                `);
            });
        }

        function initStore() {
            const store = $('#store-items');
            APPS.forEach(app => {
                store.append(`
                    <div class="bg-white/5 p-6 rounded-2xl border border-white/10 hover:border-blue-500 transition">
                        <i class="${app.icon} text-5xl mb-4 ${app.color}"></i>
                        <h3 class="text-xl font-bold">${app.name} Pro</h3>
                        <p class="text-xs text-gray-500 mb-6">Phiên bản doanh nghiệp hỗ trợ đa nền tảng.</p>
                        <button class="w-full bg-blue-600 py-2 rounded-lg text-sm font-bold">Installed</button>
                    </div>
                `);
            });
        }

        // --- APPS LOGIC ---
        function openWin(id) {
            $(`#${id}`).fadeIn(200).css('display', 'flex');
            updateActiveApps();
        }

        function closeWin(id) {
            $(`#${id}`).fadeOut(200);
            updateActiveApps();
        }

        function updateActiveApps() {
            const bar = $('#active-apps');
            bar.empty();
            $('.window:visible').each(function() {
                const id = $(this).attr('id');
                const app = APPS.find(a => `win-${a.id}` === id);
                if(app) {
                    bar.append(`<div class="w-10 h-10 bg-white/10 rounded flex items-center justify-center border-b-2 border-blue-500"><i class="${app.icon} ${app.color}"></i></div>`);
                }
            });
        }

        function updateClock() {
            const now = new Date();
            $('#clock-time').text(now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0'));
            $('#clock-date').text(now.toLocaleDateString('vi-VN'));
        }

        function showContextMenu(e) {
            e.preventDefault();
            $('#context-menu').css({ top: e.pageY, left: e.pageX }).fadeIn(100);
            return false;
        }

        $(document).click(() => $('#context-menu, #start-menu').hide());

        // --- TERMINAL LOGIC ---
        function initTerminal() {
            $('#term-input').on('keydown', function(e) {
                if(e.key === 'Enter') {
                    const cmd = $(this).val();
                    const hist = $('#term-history');
                    hist.append(`<div>root@community:~$ ${cmd}</div>`);
                    
                    // Xử lý tập lệnh khổng lồ
                    const action = cmd.toLowerCase();
                    if(action === 'help') hist.append('<div>Lệnh hỗ trợ: help, ls, clear, date, sys, whoami, open [app]</div>');
                    else if(action === 'ls') hist.append('<div>bin/  boot/  dev/  etc/  home/  lib/  root/</div>');
                    else if(action === 'clear') hist.html('');
                    else if(action === 'sys') hist.append('<div>Titanium Kernel v4.0.1-Final. Node: Community-Web-1</div>');
                    else if(action.startsWith('open ')) {
                        const target = action.replace('open ', '');
                        openWin(`win-${target}`);
                        hist.append(`<div class="text-blue-400 text-xs">Launching ${target}... Done.</div>`);
                    }
                    else hist.append(`<div class="text-red-500">Lệnh không tồn tại: ${cmd}</div>`);

                    $(this).val('');
                    $('#terminal-out').scrollTop($('#terminal-out')[0].scrollHeight);
                }
            });
        }
    </script>
</body>
</html>
